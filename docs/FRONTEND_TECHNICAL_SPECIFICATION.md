# Техническое задание для фронтенда Notes API

## Обзор проекта

Веб-приложение для создания, редактирования и совместной работы с заметками. Приложение поддерживает аутентификацию по SMS, тегирование, комментарии, реакции, совместное редактирование в реальном времени и публичный доступ к заметкам.

## Технический стек

- **Frontend**: React/Vue.js/Angular (на выбор)
- **State Management**: Redux/Vuex/NgRx
- **WebSocket**: Socket.IO Client
- **UI Framework**: Material-UI/Ant Design/Tailwind CSS
- **HTTP Client**: Axios/Fetch API
- **Form Validation**: Yup/Zod/Formik
- **Date/Time**: Day.js/Moment.js

## Use Cases (Сценарии использования)

### 1. Аутентификация и авторизация

#### UC-1.1: Регистрация пользователя

**Актор**: Неавторизованный пользователь  
**Предусловие**: Пользователь не зарегистрирован в системе  
**Основной поток**:

1. Пользователь вводит номер телефона
2. Система отправляет SMS с кодом подтверждения
3. Пользователь вводит полученный код
4. Система создает аккаунт и авторизует пользователя
5. Пользователь перенаправляется на главную страницу

**Альтернативный поток**:

- Неверный код: система показывает ошибку и предлагает повторить

**API**: `POST /auth/send-sms`, `POST /auth/login`

#### UC-1.2: Вход в систему

**Актор**: Зарегистрированный пользователь  
**Предусловие**: Пользователь уже зарегистрирован  
**Основной поток**:

1. Пользователь вводит номер телефона
2. Система отправляет SMS с кодом
3. Пользователь вводит код
4. Система авторизует пользователя
5. Пользователь перенаправляется на главную страницу

**API**: `POST /auth/send-sms`, `POST /auth/login`

#### UC-1.3: Выход из системы

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Пользователь нажимает "Выйти"
2. Система очищает токены
3. Пользователь перенаправляется на страницу входа

**API**: `POST /auth/logout`

### 2. Управление заметками

#### UC-2.1: Создание заметки

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Пользователь нажимает "Создать заметку"
2. Открывается форма создания
3. Пользователь вводит заголовок и содержимое
4. Опционально: устанавливает дедлайн и выбирает теги
5. Пользователь сохраняет заметку
6. Система создает заметку и показывает её в списке

**API**: `POST /notes`

#### UC-2.2: Просмотр списка заметок

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Пользователь открывает главную страницу
2. Система загружает список заметок пользователя
3. Заметки отображаются с заголовком, датой создания, тегами
4. Закрепленные заметки показываются вверху
5. Архивные заметки не показываются в основном списке

**Фильтрация и поиск**:

- По дате (from/to)
- По тексту в заголовке
- По тегам
- Сортировка по дате создания

**API**: `GET /notes`

#### UC-2.3: Просмотр архивных заметок

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Пользователь переходит в раздел "Архив"
2. Система загружает архивные заметки
3. Применяются те же фильтры, что и для обычных заметок

**API**: `GET /notes/archived`

#### UC-2.4: Редактирование заметки

**Актор**: Авторизованный пользователь (владелец или коллаборатор)  
**Предусловие**: Заметка существует  
**Основной поток**:

1. Пользователь открывает заметку для редактирования
2. Система загружает содержимое заметки
3. Пользователь изменяет заголовок, содержимое, теги, дедлайн
4. Пользователь сохраняет изменения
5. Система обновляет заметку

**API**: `PATCH /notes/:id`

#### UC-2.5: Удаление заметки

**Актор**: Авторизованный пользователь (только владелец)  
**Предусловие**: Заметка существует  
**Основной поток**:

1. Пользователь нажимает "Удалить" на заметке
2. Система показывает подтверждение
3. Пользователь подтверждает удаление
4. Система удаляет заметку
5. Заметка исчезает из списка

**API**: `DELETE /notes/:id`

#### UC-2.6: Закрепление заметки

**Актор**: Авторизованный пользователь (владелец)  
**Основной поток**:

1. Пользователь нажимает "Закрепить" на заметке
2. Система закрепляет заметку
3. Заметка перемещается в начало списка

**API**: `POST /notes/:id/pin`

#### UC-2.7: Архивирование заметки

**Актор**: Авторизованный пользователь (владелец)  
**Основной поток**:

1. Пользователь нажимает "Архивировать" на заметке
2. Система архивирует заметку
3. Заметка исчезает из основного списка
4. Заметка появляется в архиве

**API**: `POST /notes/:id/archive`

#### UC-2.8: Установка дедлайна

**Актор**: Авторизованный пользователь (владелец)  
**Основной поток**:

1. Пользователь нажимает "Установить дедлайн"
2. Открывается календарь
3. Пользователь выбирает дату и время
4. Система устанавливает дедлайн
5. Дедлайн отображается на заметке

**API**: `POST /notes/:id/deadline`

#### UC-2.9: Удаление дедлайна

**Актор**: Авторизованный пользователь (владелец)  
**Основной поток**:

1. Пользователь нажимает "Удалить дедлайн"
2. Система удаляет дедлайн
3. Дедлайн исчезает с заметки

**API**: `DELETE /notes/:id/deadline`

### 3. Совместное редактирование (WebSocket)

#### UC-3.1: Присоединение к совместному редактированию

**Актор**: Авторизованный пользователь (владелец или коллаборатор)  
**Предусловие**: Заметка открыта для редактирования  
**Основной поток**:

1. Пользователь открывает заметку
2. Система подключается к WebSocket комнате заметки
3. Система получает список активных пользователей
4. Отображаются курсоры других пользователей

**WebSocket**: `join` event

#### UC-3.2: Отображение курсоров других пользователей

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Система получает обновления позиций курсоров
2. Отображаются курсоры других пользователей с их именами
3. При изменении позиции курсора система отправляет обновление

**WebSocket**: `caret` event

#### UC-3.3: Синхронизация изменений в реальном времени

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Пользователь вводит текст
2. Система отправляет изменения через WebSocket
3. Другие пользователи видят изменения в реальном времени
4. Показывается индикатор "Пользователь печатает..."

**WebSocket**: `edit` event

### 4. Управление тегами

#### UC-4.1: Создание тега

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Пользователь нажимает "Добавить тег"
2. Вводит название тега
3. Система создает тег
4. Тег добавляется в список доступных тегов

**API**: `POST /tags`

#### UC-4.2: Присвоение тегов заметке

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. При создании/редактировании заметки пользователь выбирает теги
2. Система присваивает теги заметке
3. Теги отображаются на заметке

**API**: `PATCH /notes/:id` (в поле tags)

#### UC-4.3: Фильтрация по тегам

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Пользователь выбирает теги в фильтре
2. Система показывает только заметки с выбранными тегами
3. Можно выбрать несколько тегов (логика И)

**API**: `GET /notes?tags=1,2,3`

### 5. Комментарии и реакции

#### UC-5.1: Добавление комментария

**Актор**: Авторизованный пользователь (владелец или коллаборатор)  
**Основной поток**:

1. Пользователь открывает заметку
2. Прокручивает к разделу комментариев
3. Вводит текст комментария
4. Нажимает "Добавить комментарий"
5. Комментарий появляется в списке с реакциями

**API**: `POST /notes/:noteId/comments`

#### UC-5.2: Просмотр комментариев

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Пользователь открывает заметку
2. Система загружает комментарии с реакциями
3. Комментарии отображаются в хронологическом порядке
4. Показывается автор и время создания

**API**: `GET /notes/:noteId/comments`

#### UC-5.3: Редактирование комментария

**Актор**: Авторизованный пользователь (автор комментария)  
**Основной поток**:

1. Пользователь нажимает "Редактировать" на своем комментарии
2. Открывается форма редактирования
3. Пользователь изменяет текст
4. Сохраняет изменения

**API**: `PATCH /notes/:noteId/comments/:id`

#### UC-5.4: Удаление комментария

**Актор**: Авторизованный пользователь (автор комментария)  
**Основной поток**:

1. Пользователь нажимает "Удалить" на своем комментарии
2. Система показывает подтверждение
3. Пользователь подтверждает удаление
4. Комментарий удаляется

**API**: `DELETE /notes/:noteId/comments/:id`

#### UC-5.5: Добавление реакции на комментарий

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Пользователь нажимает на эмодзи под комментарием
2. Система добавляет реакцию
3. Счетчик реакции увеличивается
4. Показывается, что пользователь поставил эту реакцию

**API**: `POST /comments/:commentId/reactions`

#### UC-5.6: Удаление реакции

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Пользователь нажимает на свою реакцию
2. Система удаляет реакцию
3. Счетчик реакции уменьшается

**API**: `DELETE /reactions/:id`

### 6. Управление коллабораторами

#### UC-6.1: Добавление коллаборатора

**Актор**: Авторизованный пользователь (владелец заметки)  
**Основной поток**:

1. Пользователь нажимает "Добавить коллаборатора"
2. Вводит ID пользователя
3. Система добавляет пользователя как коллаборатора
4. Коллаборатор получает доступ к заметке

**API**: `POST /notes/:id/collaborators`

#### UC-6.2: Просмотр коллабораторов

**Актор**: Авторизованный пользователь  
**Основной поток**:

1. Пользователь открывает заметку
2. Система показывает список коллабораторов
3. Отображаются имена и даты добавления

**API**: `GET /notes/:id` (включает collaborators)

### 7. Публичный доступ

#### UC-7.1: Создание публичной ссылки

**Актор**: Авторизованный пользователь (владелец заметки)  
**Основной поток**:

1. Пользователь нажимает "Поделиться"
2. Система генерирует публичную ссылку
3. Пользователь копирует ссылку
4. Ссылку можно отправить другим людям

**API**: `POST /notes/:id/share`

#### UC-7.2: Просмотр публичной заметки

**Актор**: Любой пользователь с публичной ссылкой  
**Основной поток**:

1. Пользователь переходит по публичной ссылке
2. Система загружает заметку без авторизации
3. Отображается содержимое заметки
4. Комментарии и реакции недоступны

**API**: `GET /notes/public/:token`

## Требования к интерфейсу

### 1. Адаптивность

- Поддержка мобильных устройств
- Адаптивная сетка для разных размеров экрана
- Touch-friendly интерфейс для мобильных устройств

### 2. UX/UI принципы

- Минималистичный дизайн
- Интуитивная навигация
- Быстрая загрузка страниц
- Плавные анимации
- Обратная связь для всех действий

### 3. Состояния интерфейса

- Loading состояния для всех запросов
- Error состояния с понятными сообщениями
- Empty states для пустых списков
- Success уведомления для успешных действий

### 4. Доступность

- Поддержка клавиатурной навигации
- Screen reader compatibility
- Контрастные цвета
- Увеличенные области нажатия

## Технические требования

### 1. Производительность

- Ленивая загрузка для больших списков
- Кэширование данных
- Оптимизация изображений
- Минимизация перерендеров

### 2. Безопасность

- Валидация всех форм на клиенте
- Санитизация пользовательского ввода
- Безопасное хранение токенов
- HTTPS для всех запросов

### 3. Обработка ошибок

- Graceful degradation при сбоях сети
- Retry механизмы для неудачных запросов
- Логирование ошибок
- Пользовательские сообщения об ошибках

### 4. WebSocket соединение

- Автоматическое переподключение
- Индикатор состояния соединения
- Обработка разрывов соединения
- Queue для сообщений при отсутствии соединения

## API интеграция

### Базовый URL

```
http://localhost:3000/api
```

### Аутентификация

- JWT токены в заголовке `Authorization: Bearer <token>`
- Автоматическое обновление токенов
- Обработка 401 ошибок

### WebSocket

- Подключение: `ws://localhost:3000`
- Аутентификация через query параметр `token`
- Обработка всех событий: join, leave, caret, edit, users, error

## Тестирование

### Типы тестов

- Unit тесты для компонентов
- Integration тесты для API
- E2E тесты для критических сценариев
- WebSocket тесты

### Покрытие

- Минимум 80% покрытие кода
- Тестирование всех use cases
- Тестирование edge cases
- Performance тесты

## Деплой

### Среда разработки

- Hot reload
- Source maps
- Debug режим

### Продакшн

- Минификация кода
- Оптимизация бандла
- CDN для статических ресурсов
- Мониторинг производительности
